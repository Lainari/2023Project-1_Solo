# Chp 4. 함수 : 함수로 데이터를 쉽게 가공하기

# 1. 함수란?
- 오라클 데이터베이스 시스템에서 제공하는 함수
- 미리 정의된 기능을 통해 데이터를 좀 더 편리하게 조작할 수 있도록 도와준다
- 사용자가 입력 값 X를 넣으면 정해놓은 출력 값 Y가 나오는 개념
  - 자판기를 생각하면 된다
- 문자, 숫자, 날짜 값 등을 조작할 수 있으며 각 데이터 타입(자료형) 끼리 변환할 수도 있다
- 복수의 행을 조합하여 그룹당 하나의 결과로도 출력할 수도 있다

## 함수를 사용하는 목적
 1. 데이터 값을 계산하거나 조작(단일 행 함수)
 2. 행의 그룹에 대해 계산하거나 요약(그룹 함수)
 3. 열의 데이터 타입을 변환
   - 즉, 날짜와 숫자 등 데이터 타입을 상호 변환


# 2. 단일행 함수 : 데이터 값을 하나씩 계산하고 조작하기
- 테이블의 열은 한 가지 데이터 타입으로 지정되어 있음
  - 지정된 데이터 타입과 일치하는 데이터 값만 저장할 수 있다

## 데이터 타입의 종류
```Markdown
1. CHAR(n)      : n 크기만큼 고정 길이의 문자 타입을 저장한다
                  최대 2,000 바이트(Byte)까지 저장할 수 있다
2. VARCHAR2(n)  : n 크기만큼 가변 길이의 문자 타입을 저장한다
                  최대 4,000 바이트(Byte)까지 저장할 수 있다
3. NUMBER(p, s) : 숫자 타입을 저장한다
                  (p : 정수 자릿수, s : 소수 자릿수)
4. DATE         : 날짜 타입을 저장한다.
                  9999년 12월 31일까지 저장할 수 있다
```

## 자료형 타입별 특징
```Markdown
1. 문자 타입 함수 : 문자를 입력받아 문자와 숫자를 반환
2. 숫자 타입 함수 : 숫자를 입력받아 숫자를 반환
3. 날짜 타입 함수 : 날짜에 대해 연산
                   숫자를 반환하는 MONTHS_BETWEEN 함수를 제외한
                   모든 날짜 타입 함수는 날짜 값을 반환
4. 변환 타입 함수 : 임의의 데이터 타입의 값을 다른 데이터 타입으로 변환
5. 일반 함수      : 그 외 NVL, DECODE, CASE WHEN, 순위 함수 등
```

## 단일 행 함수의 특징
1. 각 행에 대해 수행
2. 데이터 타입에 맞는 함수를 사용해야 함
3. 행 별로 하나의 결과를 반환
4. SELECT, WHERE, ORDER BY 절 등에서 사용할 수 있음
5. 함수 속의 함수처럼 중첩해서 사용할 수 있음
6. 중첩해서 사용할 경우 가장 안쪽(하위) 단계에서 바깥쪽(상위) 단계 순으로 진행함

## ⭐문자 타입 함수
- 주로 데이터 조작에 쓰이며 문자나 문자열 데이터는 작은따옴표(')로 묶어서 문자 타입으로 표현

## 1) LOWER, UPPER, INITCAP : 데이터 값을 대소문자로 변환하기
```
1. LOWER('문자열' or 열 이름)
2. UPPER('문자열' or 열 이름)
3. INITCAP('문자열' or 열 이름)

* 열 이름 외에 'ABCD' 형태로 직접 데이터 값을 넣어도 됨
```
- SQL은 데이터 값의 대소문자를 구문하기 때문에 데이터 출력 값을 표준화할 때 유용

1. LOWER 함수   : 데이터 값을 소문자로 변환
2. UPPER 함수   : 데이터 값을 대문자로 변환
3. INITCAP 함수 : 데이터 값의 첫 번째 문자만 대문자로 변환할 떄 사용

 ### 다음의 문제에서 빈칸에 들어갈 명령어를 기술하시오
 ```
  employees 테이블에서 last_name을 소문자와 대문자로 각각 출력하고, email의 첫 번째 문자는 대문자로 출력하시오
 ```
 ```SQL
  SELECT last_name,
         [        ], 소문자 적용
         [        ], 대문자 적용
         email,
         [        ] email 첫 번째 대문자 적용
  FROM employees;
 ```

## 2) SUBSTR : 지정한 길이만큼 문자열 추출하기
```
SUBSTR('문자열' or 열 이름, 시작 위치, 길이)

* 시작 위치는 추출 시작 자리 위치를 말하며, 길이는 추출할 길이를 뜻한다
```
- SUBSTR 함수는 데이터에서 지정된 길이만큼 문자열을 추출할 때 사용
  - 데이터 값이 이미 가공되어 데이터베이스에 저장되어 있는 경우에서
    일부 문자열을 잘라내 또 다시 가공해야 할 때 유용

 ### 다음의 문제에서 빈칸에 들어갈 명령어를 기술하시오
 ```
  employees 테이블에서 job_id 데이터 값의 첫째 자리부터 시작해서 두 개의 문자를 출력하시오
 ```
 ```SQL
  SELECT
    job_id,
    [        ] 적용 결과
  FROM employees;
 ```

## 3) REPLACE : 특정 문자를 찾아 바꾸기
```
REPLACE('문자열' or 열 이름, '바꾸려는 문자열', '바뀔 문자열')
```
- REPLACE는 특정 문자열을 찾아 바꾸는 함수
  - 사용자가 바꾸고자 하는 문자나 문자열을 지정하면 지정한 형태로 문자(열)이 바뀜
 ### 다음의 문제에서 빈칸에 들어갈 명령어를 기술하시오
 ```
  employees 테이블에서 job_id 문자열 값이 ACCOUNT면 ACCNT로 출력하세요
 ```
 ```SQL
  SELECT
    job_id,
    [          ] 적용결과
  FROM employees;
 ```

## 4) LPAD, RPAD : 특정 문자로 자릿수 채우기
```
LPAD or RPAD('문자열' or 열 이름, 만들어질 자릿수, '채워질 문자')
```
- LPAD는 왼쪽부터 특정 문자로 자릿수를 채우고 RPAD는 오른쪽에서 시작한다

 ### 다음의 문제에서 빈칸에 들어갈 명령어를 기술하시오
 ```
  employees 테이블에서 first_name에 대해 12자리의 문자열 자리를 만들어라
  여기서 first_name의 데이터 값이 12자리보다 작으면 왼쪽에서부터 * 를 채워서  출력하라
 ```
 ```SQL
   SELECT
    first_name,
    [            ] 적용결과
   FROM employees;
 ```
 - 오른쪽에서도 넣은 결과도 따로 확인해보세요

## 5) LTRIM, RTRIM : 특정 문자 삭제하기
```
LTRIM('문자열' or 열 이름, '삭제할 문자')

* 삭제할 문자가 없다면 공백을 제거한다
```
- LTRIM은 왼쪽부터 지정한 문자를 지우는 함수며 RTRIM은 오른쪽부터 제거한다
- 지정한 문자 외의 값을 만나면 진행을 중단한다
 ### 다음의 문제에서 빈칸에 들어갈 명령어를 기술하시오
 ```

 ```